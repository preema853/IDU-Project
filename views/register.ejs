<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(to right, #6a11cb, #2575fc);
        }

        .container-tight {
            max-height: 90vh; /* Sets a maximum height relative to the viewport height */
            overflow-y: auto; /* Adds a scrollbar only if content exceeds the max-height */
            padding-bottom: 2rem; /* Adds some padding at the bottom for spacing */
        }
    </style>
</head>

<body class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-white p-10 rounded-xl shadow-2xl w-full max-w-md transform transition-all duration-300 hover:scale-105 container-tight">
        <div class="text-center mb-6">
            <h2 class="text-3xl font-extrabold text-gray-900">Create a new account</h2>
            <p class="mt-2 text-sm text-gray-600">Or <a href="/login" class="font-medium text-indigo-600 hover:text-indigo-500">sign in</a> if you already have one</p>
        </div>
        <% if (error) { %>
            <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4" role="alert">
                <span class="block sm:inline"><%= error %></span>
            </div>
        <% } %>
        <form action="/register" method="POST" class="space-y-4">
            <div>
                <label for="username" class="block text-sm font-medium text-gray-700">Username</label>
                <input type="text" id="username" name="username" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
            </div>
            <div>
                <label for="email" class="block text-sm font-medium text-gray-700">Email Address</label>
                <input type="email" id="email" name="email" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
            </div>
            <div>
                <label for="password" class="block text-sm font-medium text-gray-700">Password</label>
                <input type="password" id="password" name="password" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
            </div>
            <div>
                <label for="role" class="block text-sm font-medium text-gray-700">Role</label>
                <select id="role" name="role" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" onchange="toggleStudentFields()">
                    <option value="student">Student</option>
                    <option value="dean">Dean</option>
                    <option value="admin">Admin</option>
                    <option value="sig">SIG</option>
                </select>
            </div>
            <div id="student-fields" class="space-y-4">
                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700">Full Name</label>
                    <input type="text" id="name" name="name" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div>
                    <label for="reg_number" class="block text-sm font-medium text-gray-700">Registration Number</label>
                    <input type="text" id="reg_number" name="reg_number" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div>
                    <label for="department_id" class="block text-sm font-medium text-gray-700">Department</label>
                    <select id="department_id" name="department_id" class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                        <% if (departments) { %>
                            <% departments.forEach(dept => { %>
                                <option value="<%= dept.id %>"><%= dept.name %></option>
                            <% }); %>
                        <% } %>
                    </select>
                </div>
            </div>
            <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200">
                Register
            </button>
        </form>
        <script>
            function toggleStudentFields() {
                const role = document.getElementById('role').value;
                const studentFields = document.getElementById('student-fields');
                const nameInput = document.getElementById('name');
                const regNumberInput = document.getElementById('reg_number');
                const deptSelect = document.getElementById('department_id');

                if (role === 'student') {
                    studentFields.style.display = 'block';
                    nameInput.setAttribute('required', 'required');
                    regNumberInput.setAttribute('required', 'required');
                    deptSelect.setAttribute('required', 'required');
                } else {
                    studentFields.style.display = 'none';
                    nameInput.removeAttribute('required');
                    regNumberInput.removeAttribute('required');
                    deptSelect.removeAttribute('required');
                }
            }
            window.onload = toggleStudentFields;
        </script>
    </div>
</body>
</html>